source ../test_functions.bsh

setup

# remove and create the unit_test
create_unit_test test.sv
cd another_test && create_unit_test test0.sv && cd -

# create the Makefile
create_svunit.pl

## build the svunit_top
make .svunit_top.sv

## massage the testsuite golden reference
#TS_TYPE=`pwd | sed -e "s/[\/-]/_/g"`_testsuite
#TS_INST=`pwd | sed -e "s/[\/-]/_/g"`_ts
#ATS_TYPE=`pwd | sed -e "s/[\/-]/_/g"`_another_test_testsuite
#ATS_INST=`pwd | sed -e "s/[\/-]/_/g"`_another_test_ts
#
#sed -e "s/TS_TYPE/$TS_TYPE/g" testsuite.gold | sed -e "s/TS_INST/$TS_INST/g" > .testsuite.gold
#sed -e "s/ATS_TYPE/$ATS_TYPE/g" testrunner.gold | sed -e "s/ATS_INST/$ATS_INST/g" | sed -e "s/TS_TYPE/$TS_TYPE/g" | sed -e "s/TS_INST/$TS_INST/g" > .testrunner.gold
#sed -e "s/TS_TYPE/$ATS_TYPE/g" ./another_test/testsuite.gold | sed -e "s/TS_INST/$ATS_INST/g" > ./another_test/.testsuite.gold

translate_testsuite_gold testsuite.gold
translate_testsuite_gold testsuite.gold another_test
translate_testrunner_gold testrunner.gold


# do the checking
gold=(  test_unit_test.gold    .testsuite.gold   ./another_test/.testsuite.gold  .testrunner.gold )
output=( test_unit_test.sv      .$TS_TYPE.sv      ./another_test/.$ATS_TYPE.sv    .testrunner.sv   )

verify
