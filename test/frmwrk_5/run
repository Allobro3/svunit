source ../test_functions.bsh

setup

# remove and create the unit_test
create_unit_test.pl -overwrite -out ./another_test/test0_unit_test.sv ./another_test/test0.sv

# create the Makefile
create_svunit.pl

# verify that nothing from another_test/empty_dir gets into the Makefil
expect_file_does_not_contain empty_dir Makefile &&

# cd to the child dir
cd another_test

## build the svunit_top
make .testrunner.sv

golden_class_unit_test test0 test0
golden_testsuite_with_1_unittest test0
golden_testrunner_with_1_testsuite
verify_file test0_unit_test.gold test0_unit_test.sv &&
verify_testsuite testsuite.gold &&
verify_testrunner testrunner.gold
