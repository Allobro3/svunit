# create the Makefile
create_svunit.pl

# build and run svunit with qverilog
make


expect_file run.log

expect_string "INFO:  \[0\]\[_.*_ts\]: _.*_ts::RUNNING" run.log
expect_string "INFO:  \[0\]\[dut_ut\]: dut_ut::RUNNING" run.log
expect_string "INFO:  \[0\]\[dut_ut\]: dut_ut::first_test::RUNNING" run.log
expect_string "INFO:  \[0\]\[dut_ut\]: dut_ut::first_test::PASSED" run.log
expect_string "INFO:  \[0\]\[dut_ut\]: dut_ut::second_test::RUNNING" run.log
expect_string "ERROR: \[0\]\[dut_ut\]: fail_if: 1 (at .*dut_unit_test.sv line:66): FAIL" run.log
expect_string "INFO:  \[0\]\[dut_ut\]: dut_ut::second_test::FAILED" run.log
expect_string "INFO:  \[0\]\[dut_ut\]: dut_ut::third_test::RUNNING" run.log
expect_string "ERROR: \[0\]\[dut_ut\]: fail_unless: beam == 1 (at .*dut_unit_test.sv line:73): FAIL" run.log
expect_string "INFO:  \[0\]\[dut_ut\]: dut_ut::third_test::FAILED" run.log
expect_string "INFO:  \[0\]\[dut_ut\]: dut_ut::FAILED" run.log
expect_string "INFO:  \[0\]\[_.*_ts\]: _.*_ts::FAILED" run.log
expect_string "INFO:  \[0\]\[testrunner\]: Testrunner::FAILED" run.log

exit 0
